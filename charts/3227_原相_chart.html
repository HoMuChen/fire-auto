<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>原相(3227) — RSI+Bollinger</title>
<script src="https://cdn.jsdelivr.net/npm/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { background: #0a0e17; color: #d1d5db; font-family: -apple-system, 'Noto Sans TC', sans-serif; }
  .header { padding: 24px 32px 16px; border-bottom: 1px solid #1e2433; }
  .header h1 { font-size: 22px; color: #f0f0f0; font-weight: 600; }
  .header .subtitle { color: #8892a4; font-size: 13px; margin-top: 4px; }
  .stats-bar { display: flex; gap: 32px; padding: 16px 32px; border-bottom: 1px solid #1e2433; flex-wrap: wrap; }
  .stat { display: flex; flex-direction: column; }
  .stat .label { font-size: 11px; color: #6b7280; text-transform: uppercase; letter-spacing: 0.5px; }
  .stat .value { font-size: 18px; font-weight: 600; margin-top: 2px; }
  .stat .value.green { color: #22c55e; }
  .stat .value.red { color: #ef4444; }
  .stat .value.blue { color: #3b82f6; }
  .chart-section { padding: 16px 32px 8px; }
  .chart-section h2 { font-size: 14px; color: #8892a4; margin-bottom: 8px; font-weight: 500; }
  .chart-container { border: 1px solid #1e2433; border-radius: 8px; overflow: hidden; background: #0f1320; }
  .legend { display: flex; gap: 20px; padding: 10px 16px; background: #0f1320; border-bottom: 1px solid #1e2433; font-size: 12px; flex-wrap: wrap; }
  .legend-item { display: flex; align-items: center; gap: 6px; }
  .legend-line { width: 16px; height: 2px; }
  .legend-marker { width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; }
  .legend-marker.buy { border-bottom: 8px solid #22c55e; }
  .legend-marker.sell { border-top: 8px solid #ef4444; }
  .legend-marker.stop { border-top: 8px solid #f59e0b; }
  .trades-table { padding: 16px 32px 32px; }
  .trades-table h2 { font-size: 14px; color: #8892a4; margin-bottom: 8px; font-weight: 500; }
  table { width: 100%; border-collapse: collapse; font-size: 13px; }
  th { text-align: left; padding: 8px 12px; background: #141825; color: #6b7280; font-weight: 500; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; border-bottom: 1px solid #1e2433; }
  td { padding: 8px 12px; border-bottom: 1px solid #1a1f2e; }
  tr:hover td { background: #141825; }
  .win { color: #22c55e; }
  .lose { color: #ef4444; }
  .stop-tag { display: inline-block; padding: 1px 6px; border-radius: 3px; background: #f59e0b22; color: #f59e0b; font-size: 11px; }
  .signal-tag { display: inline-block; padding: 1px 6px; border-radius: 3px; background: #3b82f622; color: #3b82f6; font-size: 11px; }
  .forced-tag { display: inline-block; padding: 1px 6px; border-radius: 3px; background: #6b728022; color: #6b7280; font-size: 11px; }
  .nav { padding: 12px 32px; border-bottom: 1px solid #1e2433; display: flex; gap: 8px; flex-wrap: wrap; }
  .nav a { color: #3b82f6; text-decoration: none; font-size: 12px; padding: 4px 10px; border: 1px solid #1e2433; border-radius: 4px; }
  .nav a:hover { background: #1e2433; }
  .nav a.current { background: #3b82f622; border-color: #3b82f6; }
</style>
</head>
<body>

<div class="nav"><a href="5225_東科-KY_chart.html">東科-KY(5225)</a>
<a href="7516_清淨海_chart.html">清淨海(7516)</a>
<a href="6621_華宇藥_chart.html">華宇藥(6621)</a>
<a href="3227_原相_chart.html" class="current">原相(3227)</a>
<a href="6114_久威_chart.html">久威(6114)</a>
<a href="8105_凌巨_chart.html">凌巨(8105)</a>
<a href="2362_藍天_chart.html">藍天(2362)</a>
<a href="3708_上緯投控_chart.html">上緯投控(3708)</a>
<a href="4749_新應材_chart.html">新應材(4749)</a>
<a href="2637_慧洋-KY_chart.html">慧洋-KY(2637)</a>
<a href="6829_千附精密_chart.html">千附精密(6829)</a>
<a href="6165_浪凡_chart.html">浪凡(6165)</a>
<a href="7825_和亞智慧_chart.html">和亞智慧(7825)</a></div>

<div class="header">
  <h1>原相(3227) — RSI+Bollinger</h1>
  <div class="subtitle">RSI(14)<35且低於布林下軌買入，RSI>65或碰上軌賣出 ｜ ATR停損：買入價-2.5×ATR(14) ｜ 2024-02-15 ~ 2026-02-25</div>
</div>

<div class="stats-bar" id="stats-bar"></div>

<div class="chart-section">
  <h2>股價走勢 + 進出場點位</h2>
  <div class="chart-container">
    <div class="legend">
      <div class="legend-item"><div class="legend-line" style="background:#3b82f6"></div> 收盤價</div>
      <div class="legend-item"><div class="legend-line" style="background:#f59e0b;"></div> 布林中線</div>
      <div class="legend-item"><div class="legend-line" style="background:rgba(239,68,68,0.4);opacity:0.5;"></div> 布林上軌</div>
      <div class="legend-item"><div class="legend-line" style="background:rgba(34,197,94,0.4);opacity:0.5;"></div> 布林下軌</div>
      <div class="legend-item"><div class="legend-marker buy"></div> 買入</div>
      <div class="legend-item"><div class="legend-marker sell"></div> 賣出</div>
      <div class="legend-item"><div class="legend-marker stop"></div> 停損</div>
    </div>
    <div id="price-chart" style="height: 420px;"></div>
  </div>
</div>

<div class="chart-section">
  <h2>資金成長曲線</h2>
  <div class="chart-container">
    <div id="equity-chart" style="height: 260px;"></div>
  </div>
</div>

<div class="trades-table">
  <h2>交易明細</h2>
  <table id="trades-tbody"></table>
</div>

<script>
const DATA = {"dates": ["2024-02-26", "2024-02-27", "2024-02-29", "2024-03-01", "2024-03-04", "2024-03-05", "2024-03-06", "2024-03-07", "2024-03-08", "2024-03-11", "2024-03-12", "2024-03-13", "2024-03-14", "2024-03-15", "2024-03-18", "2024-03-19", "2024-03-20", "2024-03-21", "2024-03-22", "2024-03-25", "2024-03-26", "2024-03-27", "2024-03-28", "2024-03-29", "2024-04-01", "2024-04-02", "2024-04-03", "2024-04-08", "2024-04-09", "2024-04-10", "2024-04-11", "2024-04-12", "2024-04-15", "2024-04-16", "2024-04-17", "2024-04-18", "2024-04-19", "2024-04-22", "2024-04-23", "2024-04-24", "2024-04-25", "2024-04-26", "2024-04-29", "2024-04-30", "2024-05-02", "2024-05-03", "2024-05-06", "2024-05-07", "2024-05-08", "2024-05-09", "2024-05-10", "2024-05-13", "2024-05-14", "2024-05-15", "2024-05-16", "2024-05-17", "2024-05-20", "2024-05-21", "2024-05-22", "2024-05-23", "2024-05-24", "2024-05-27", "2024-05-28", "2024-05-29", "2024-05-30", "2024-05-31", "2024-06-03", "2024-06-04", "2024-06-05", "2024-06-06", "2024-06-07", "2024-06-11", "2024-06-12", "2024-06-13", "2024-06-14", "2024-06-17", "2024-06-18", "2024-06-19", "2024-06-20", "2024-06-21", "2024-06-24", "2024-06-25", "2024-06-26", "2024-06-27", "2024-06-28", "2024-07-01", "2024-07-02", "2024-07-03", "2024-07-04", "2024-07-05", "2024-07-08", "2024-07-09", "2024-07-10", "2024-07-11", "2024-07-12", "2024-07-15", "2024-07-16", "2024-07-17", "2024-07-18", "2024-07-19", "2024-07-22", "2024-07-23", "2024-07-26", "2024-07-29", "2024-07-30", "2024-07-31", "2024-08-01", "2024-08-02", "2024-08-05", "2024-08-06", "2024-08-07", "2024-08-08", "2024-08-09", "2024-08-12", "2024-08-13", "2024-08-14", "2024-08-15", "2024-08-16", "2024-08-19", "2024-08-20", "2024-08-21", "2024-08-22", "2024-08-23", "2024-08-26", "2024-08-27", "2024-08-28", "2024-08-29", "2024-08-30", "2024-09-02", "2024-09-03", "2024-09-04", "2024-09-05", "2024-09-06", "2024-09-09", "2024-09-10", "2024-09-11", "2024-09-12", "2024-09-13", "2024-09-16", "2024-09-18", "2024-09-19", "2024-09-20", "2024-09-23", "2024-09-24", "2024-09-25", "2024-09-26", "2024-09-27", "2024-09-30", "2024-10-01", "2024-10-04", "2024-10-07", "2024-10-08", "2024-10-09", "2024-10-11", "2024-10-14", "2024-10-15", "2024-10-16", "2024-10-17", "2024-10-18", "2024-10-21", "2024-10-22", "2024-10-23", "2024-10-24", "2024-10-25", "2024-10-28", "2024-10-29", "2024-10-30", "2024-11-01", "2024-11-04", "2024-11-05", "2024-11-06", "2024-11-07", "2024-11-08", "2024-11-11", "2024-11-12", "2024-11-13", "2024-11-14", "2024-11-15", "2024-11-18", "2024-11-19", "2024-11-20", "2024-11-21", "2024-11-22", "2024-11-25", "2024-11-26", "2024-11-27", "2024-11-28", "2024-11-29", "2024-12-02", "2024-12-03", "2024-12-04", "2024-12-05", "2024-12-06", "2024-12-09", "2024-12-10", "2024-12-11", "2024-12-12", "2024-12-13", "2024-12-16", "2024-12-17", "2024-12-18", "2024-12-19", "2024-12-20", "2024-12-23", "2024-12-24", "2024-12-25", "2024-12-26", "2024-12-27", "2024-12-30", "2024-12-31", "2025-01-02", "2025-01-03", "2025-01-06", "2025-01-07", "2025-01-08", "2025-01-09", "2025-01-10", "2025-01-13", "2025-01-14", "2025-01-15", "2025-01-16", "2025-01-17", "2025-01-20", "2025-01-21", "2025-01-22", "2025-02-03", "2025-02-04", "2025-02-05", "2025-02-06", "2025-02-07", "2025-02-10", "2025-02-11", "2025-02-12", "2025-02-13", "2025-02-14", "2025-02-17", "2025-02-18", "2025-02-19", "2025-02-20", "2025-02-21", "2025-02-24", "2025-02-25", "2025-02-26", "2025-02-27", "2025-03-03", "2025-03-04", "2025-03-05", "2025-03-06", "2025-03-07", "2025-03-10", "2025-03-11", "2025-03-12", "2025-03-13", "2025-03-14", "2025-03-17", "2025-03-18", "2025-03-19", "2025-03-20", "2025-03-21", "2025-03-24", "2025-03-25", "2025-03-26", "2025-03-27", "2025-03-28", "2025-03-31", "2025-04-01", "2025-04-02", "2025-04-07", "2025-04-08", "2025-04-09", "2025-04-10", "2025-04-11", "2025-04-14", "2025-04-15", "2025-04-16", "2025-04-17", "2025-04-18", "2025-04-21", "2025-04-22", "2025-04-23", "2025-04-24", "2025-04-25", "2025-04-28", "2025-04-29", "2025-04-30", "2025-05-02", "2025-05-05", "2025-05-06", "2025-05-07", "2025-05-08", "2025-05-09", "2025-05-12", "2025-05-13", "2025-05-14", "2025-05-15", "2025-05-16", "2025-05-19", "2025-05-20", "2025-05-21", "2025-05-22", "2025-05-23", "2025-05-26", "2025-05-27", "2025-05-28", "2025-05-29", "2025-06-02", "2025-06-03", "2025-06-04", "2025-06-05", "2025-06-06", "2025-06-09", "2025-06-10", "2025-06-11", "2025-06-12", "2025-06-13", "2025-06-16", "2025-06-17", "2025-06-18", "2025-06-19", "2025-06-20", "2025-06-23", "2025-06-24", "2025-06-25", "2025-06-26", "2025-06-27", "2025-06-30", "2025-07-01", "2025-07-02", "2025-07-03", "2025-07-04", "2025-07-07", "2025-07-08", "2025-07-09", "2025-07-10", "2025-07-11", "2025-07-14", "2025-07-15", "2025-07-16", "2025-07-17", "2025-07-18", "2025-07-21", "2025-07-22", "2025-07-23", "2025-07-24", "2025-07-25", "2025-07-28", "2025-07-29", "2025-07-30", "2025-07-31", "2025-08-01", "2025-08-04", "2025-08-05", "2025-08-06", "2025-08-07", "2025-08-08", "2025-08-11", "2025-08-12", "2025-08-13", "2025-08-14", "2025-08-15", "2025-08-18", "2025-08-19", "2025-08-20", "2025-08-21", "2025-08-22", "2025-08-25", "2025-08-26", "2025-08-27", "2025-08-28", "2025-08-29", "2025-09-01", "2025-09-02", "2025-09-03", "2025-09-04", "2025-09-05", "2025-09-08", "2025-09-09", "2025-09-10", "2025-09-11", "2025-09-12", "2025-09-15", "2025-09-16", "2025-09-17", "2025-09-18", "2025-09-19", "2025-09-22", "2025-09-23", "2025-09-24", "2025-09-25", "2025-09-26", "2025-09-30", "2025-10-01", "2025-10-02", "2025-10-03", "2025-10-07", "2025-10-08", "2025-10-09", "2025-10-13", "2025-10-14", "2025-10-15", "2025-10-16", "2025-10-17", "2025-10-20", "2025-10-21", "2025-10-22", "2025-10-23", "2025-10-27", "2025-10-28", "2025-10-29", "2025-10-30", "2025-10-31", "2025-11-03", "2025-11-04", "2025-11-05", "2025-11-06", "2025-11-07", "2025-11-10", "2025-11-11", "2025-11-12", "2025-11-13", "2025-11-14", "2025-11-17", "2025-11-18", "2025-11-19", "2025-11-20", "2025-11-21", "2025-11-24", "2025-11-25", "2025-11-26", "2025-11-27", "2025-11-28", "2025-12-01", "2025-12-02", "2025-12-03", "2025-12-04", "2025-12-05", "2025-12-08", "2025-12-09", "2025-12-10", "2025-12-11", "2025-12-12", "2025-12-15", "2025-12-16", "2025-12-17", "2025-12-18", "2025-12-19", "2025-12-22", "2025-12-23", "2025-12-24", "2025-12-26", "2025-12-29", "2025-12-30", "2025-12-31", "2026-01-02", "2026-01-05", "2026-01-06", "2026-01-07", "2026-01-08", "2026-01-09", "2026-01-12", "2026-01-13", "2026-01-14", "2026-01-15", "2026-01-16", "2026-01-19", "2026-01-20", "2026-01-21", "2026-01-22", "2026-01-23", "2026-01-26", "2026-01-27", "2026-01-28", "2026-01-29", "2026-01-30", "2026-02-02", "2026-02-03", "2026-02-04", "2026-02-05", "2026-02-06", "2026-02-09", "2026-02-10", "2026-02-11", "2026-02-23", "2026-02-24", "2026-02-25"], "closes": [179.5, 173.5, 171.0, 169.0, 169.0, 170.0, 167.0, 160.5, 156.5, 157.0, 158.0, 156.0, 153.0, 151.5, 155.5, 155.5, 153.0, 161.0, 159.5, 162.0, 158.5, 159.0, 154.0, 155.5, 156.5, 156.0, 156.5, 155.0, 155.5, 158.5, 160.0, 159.5, 154.5, 146.5, 150.5, 150.5, 146.0, 141.0, 148.5, 152.5, 151.0, 157.0, 156.5, 158.5, 156.5, 158.0, 153.0, 155.0, 154.5, 153.5, 153.5, 152.5, 152.5, 160.0, 157.5, 159.5, 159.0, 161.5, 166.5, 159.0, 159.0, 163.0, 165.5, 169.0, 171.5, 163.5, 164.5, 162.0, 160.5, 159.0, 160.5, 163.5, 165.5, 169.0, 167.5, 169.0, 166.0, 166.0, 174.5, 165.0, 161.5, 167.5, 169.5, 172.0, 170.0, 168.0, 170.0, 174.0, 173.0, 188.0, 184.5, 179.0, 179.5, 180.5, 179.0, 179.5, 184.0, 178.0, 173.0, 174.5, 172.0, 170.0, 167.5, 162.5, 165.0, 163.0, 171.0, 165.5, 149.0, 146.0, 154.5, 159.5, 163.5, 175.5, 182.0, 182.5, 196.0, 194.5, 194.0, 199.0, 204.5, 212.5, 212.0, 206.0, 205.5, 205.0, 203.0, 207.5, 206.0, 205.0, 199.5, 202.0, 207.5, 212.5, 213.5, 223.5, 223.5, 237.0, 235.0, 222.0, 244.0, 259.0, 263.0, 259.0, 270.0, 275.5, 272.0, 269.0, 272.0, 260.5, 266.5, 248.0, 263.0, 271.5, 264.0, 258.0, 249.0, 249.5, 247.0, 253.5, 255.0, 254.5, 246.5, 250.0, 243.0, 233.0, 244.0, 244.0, 242.0, 237.0, 243.5, 259.0, 233.5, 233.5, 226.0, 226.0, 209.0, 201.0, 200.0, 203.5, 203.0, 208.5, 206.5, 214.0, 213.0, 207.0, 209.0, 213.5, 212.0, 221.0, 229.0, 230.0, 231.0, 239.5, 240.0, 243.0, 241.0, 235.0, 234.5, 247.0, 245.0, 241.0, 237.0, 242.0, 237.0, 238.0, 259.0, 252.5, 250.5, 256.0, 247.5, 243.5, 245.5, 246.5, 249.0, 241.0, 241.0, 224.5, 230.5, 231.0, 239.5, 235.0, 243.0, 239.5, 243.0, 246.0, 249.0, 260.0, 252.0, 265.0, 258.5, 260.5, 253.0, 254.0, 268.5, 285.0, 281.5, 289.5, 286.0, 285.5, 284.0, 276.0, 275.5, 271.5, 263.5, 268.0, 274.5, 272.5, 260.0, 258.0, 253.0, 248.5, 238.5, 240.5, 234.0, 239.5, 229.0, 247.0, 248.0, 238.0, 245.0, 252.5, 253.5, 240.5, 223.0, 230.5, 237.0, 213.5, 192.5, 173.5, 190.5, 194.5, 189.0, 200.5, 197.0, 199.0, 200.5, 192.0, 191.0, 201.0, 205.0, 217.0, 222.0, 220.5, 214.0, 218.0, 208.5, 209.0, 206.5, 212.0, 216.0, 215.0, 218.5, 220.5, 221.5, 220.5, 209.0, 217.5, 221.5, 221.5, 217.0, 218.5, 213.0, 216.0, 221.0, 216.5, 219.5, 225.0, 228.0, 223.0, 212.0, 213.5, 220.0, 224.5, 221.0, 219.5, 221.0, 222.0, 218.5, 216.0, 214.5, 221.0, 220.0, 224.0, 232.5, 229.5, 244.0, 247.0, 252.5, 244.5, 239.5, 217.0, 212.5, 210.0, 211.5, 206.5, 205.0, 205.0, 208.0, 209.5, 207.0, 200.0, 203.0, 204.5, 203.0, 202.5, 200.0, 198.5, 196.0, 200.0, 200.0, 203.0, 199.5, 204.0, 200.5, 194.0, 192.5, 211.5, 201.0, 196.5, 194.5, 190.5, 184.0, 187.0, 186.0, 190.5, 196.0, 197.0, 197.0, 197.5, 193.5, 194.5, 200.5, 199.0, 201.0, 205.0, 218.5, 217.5, 212.0, 216.5, 217.5, 219.5, 224.0, 237.5, 246.5, 243.0, 239.5, 242.0, 242.5, 237.5, 242.5, 238.5, 242.5, 256.5, 249.0, 242.0, 238.0, 239.0, 230.0, 227.5, 235.5, 234.5, 237.0, 243.0, 244.0, 241.5, 238.5, 236.0, 238.5, 232.0, 232.0, 234.0, 229.5, 233.0, 231.0, 226.0, 228.0, 224.0, 225.0, 222.5, 213.0, 211.0, 203.0, 199.5, 206.0, 198.0, 198.0, 204.5, 208.5, 208.0, 209.0, 209.0, 209.0, 207.5, 206.5, 206.5, 209.5, 205.5, 204.0, 204.5, 203.5, 206.0, 203.0, 201.0, 199.0, 205.5, 206.0, 202.0, 203.0, 200.5, 202.5, 202.5, 202.5, 206.0, 205.0, 211.0, 210.5, 206.5, 208.0, 209.5, 208.0, 211.5, 209.0, 209.0, 208.5, 210.5, 204.5, 206.5, 216.5, 215.5, 216.0, 214.5, 208.5, 199.5, 195.0, 192.0, 195.5, 192.0, 187.0, 185.5, 193.5, 191.0, 198.0, 205.0, 206.0], "overlays": [{"name": "布林中線", "color": "#f59e0b", "data": [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, 161.9, 160.85, 160.12, 159.28, 158.6, 157.97, 157.28, 156.75, 156.47, 156.43, 156.5, 156.6, 156.78, 156.85, 156.6, 156.35, 156.1, 155.75, 154.75, 154.2, 153.72, 153.35, 153.25, 153.38, 153.53, 153.53, 153.62, 153.45, 153.45, 153.4, 153.15, 152.82, 152.47, 152.38, 153.05, 153.4, 153.85, 154.5, 155.53, 156.43, 156.75, 157.15, 157.45, 157.9, 158.43, 159.18, 159.45, 160.03, 160.38, 160.68, 160.95, 161.3, 161.85, 162.5, 162.95, 163.45, 163.93, 164.28, 164.5, 164.9, 165.2, 165.32, 165.55, 165.75, 165.9, 165.82, 166.05, 166.32, 166.93, 167.55, 169.0, 170.2, 170.97, 171.68, 172.25, 172.82, 173.35, 174.25, 174.85, 174.78, 175.25, 175.78, 175.9, 175.8, 175.32, 175.07, 174.82, 174.88, 174.45, 173.25, 171.15, 169.65, 168.68, 167.88, 167.62, 167.78, 167.93, 168.53, 169.35, 170.4, 171.62, 173.25, 175.38, 177.6, 179.78, 181.8, 183.9, 185.5, 187.6, 190.45, 193.4, 195.65, 197.78, 199.97, 201.82, 203.4, 205.45, 206.82, 208.95, 211.0, 212.15, 214.12, 216.45, 219.0, 221.65, 224.88, 228.4, 231.85, 234.93, 238.22, 241.0, 244.35, 246.65, 249.43, 252.38, 254.9, 256.62, 257.9, 258.52, 259.12, 260.7, 261.25, 261.02, 260.2, 259.75, 258.4, 256.27, 254.88, 253.62, 252.12, 250.95, 249.8, 250.35, 248.88, 246.97, 245.07, 243.47, 241.47, 239.05, 236.7, 234.2, 231.6, 229.3, 227.3, 225.5, 224.0, 222.7, 220.95, 219.43, 217.93, 217.12, 216.4, 214.95, 214.82, 215.12, 215.82, 216.68, 218.28, 219.97, 221.7, 223.88, 225.97, 227.6, 229.12, 230.53, 231.72, 233.28, 235.78, 237.72, 239.65, 241.4, 242.32, 243.0, 243.72, 244.07, 244.53, 244.43, 244.43, 243.9, 243.7, 242.9, 242.62, 242.32, 242.62, 242.5, 242.8, 243.2, 242.7, 243.07, 243.15, 243.6, 244.15, 245.0, 245.38, 245.75, 246.72, 248.93, 250.95, 254.2, 256.98, 259.7, 261.93, 263.98, 265.6, 267.2, 268.23, 269.32, 270.6, 271.23, 271.62, 271.27, 271.0, 270.4, 269.68, 269.0, 267.27, 265.0, 262.38, 260.25, 258.35, 255.97, 254.03, 252.85, 251.75, 250.2, 248.18, 246.3, 244.43, 241.47, 238.1, 233.88, 230.75, 228.05, 225.57, 223.57, 221.72, 219.7, 218.28, 215.53, 212.68, 210.82, 208.82, 207.05, 205.47, 204.47, 204.03, 203.4, 201.97, 201.75, 202.45, 204.38, 205.65, 206.68, 208.15, 209.15, 210.38, 211.45, 211.88, 213.15, 214.68, 215.7, 216.3, 216.38, 215.93, 215.7, 216.05, 215.97, 216.53, 217.32, 218.4, 218.95, 218.75, 218.68, 218.75, 218.95, 218.93, 218.88, 219.47, 219.7, 219.55, 219.28, 219.15, 219.28, 219.62, 220.03, 220.6, 221.25, 222.47, 223.57, 224.8, 225.88, 227.25, 227.43, 227.05, 226.32, 225.85, 225.2, 224.4, 223.55, 223.03, 222.7, 222.32, 221.28, 220.43, 219.45, 217.97, 216.62, 214.43, 212.0, 209.18, 206.95, 204.97, 204.28, 203.62, 203.32, 202.78, 202.15, 201.53, 201.85, 201.5, 200.85, 200.22, 199.75, 198.8, 197.93, 197.07, 196.47, 196.28, 196.2, 196.25, 196.12, 195.8, 195.38, 195.43, 195.18, 195.2, 195.75, 197.05, 197.35, 197.9, 198.9, 200.05, 201.5, 203.5, 206.03, 209.05, 211.68, 213.85, 216.1, 218.38, 220.38, 222.82, 225.03, 227.12, 230.0, 232.4, 234.25, 235.22, 236.3, 237.2, 237.75, 238.65, 239.4, 240.05, 240.32, 240.2, 240.12, 240.07, 239.78, 239.57, 239.3, 238.78, 238.55, 237.9, 236.72, 235.82, 235.03, 234.53, 233.78, 233.53, 233.28, 232.15, 230.97, 229.28, 227.1, 225.2, 223.03, 221.0, 219.43, 217.93, 216.72, 215.57, 214.32, 213.3, 212.03, 210.8, 209.82, 208.9, 207.97, 206.93, 206.03, 205.55, 205.3, 205.3, 205.38, 205.03, 205.4, 205.8, 205.68, 205.4, 205.03, 204.7, 204.38, 204.05, 203.97, 203.9, 204.12, 204.18, 204.22, 204.43, 204.68, 204.9, 205.18, 205.47, 205.88, 206.35, 206.6, 206.53, 206.75, 207.43, 208.18, 208.85, 209.45, 209.75, 209.43, 208.93, 207.97, 207.22, 206.5, 205.45, 204.25, 203.53, 202.5, 201.95, 201.75, 201.62]}, {"name": "布林上軌", "color": "rgba(239,68,68,0.4)", "style": 2, "data": [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, 177.26, 173.96, 171.89, 170.2, 168.68, 166.88, 164.29, 162.16, 161.65, 161.61, 161.76, 162.05, 162.36, 162.26, 163.29, 163.54, 163.73, 164.48, 165.25, 164.79, 163.71, 163.15, 162.86, 163.09, 163.45, 163.45, 163.69, 163.43, 163.43, 163.35, 162.82, 161.98, 161.1, 160.95, 161.79, 162.26, 162.99, 163.15, 162.15, 163.84, 164.01, 163.97, 164.73, 165.96, 167.83, 170.11, 170.53, 170.9, 171.03, 170.98, 170.76, 170.5, 170.15, 169.74, 170.62, 170.93, 171.55, 171.6, 171.75, 173.33, 173.18, 172.99, 173.19, 173.58, 174.08, 173.83, 174.03, 174.45, 175.45, 175.93, 180.44, 182.8, 183.73, 184.69, 185.75, 186.44, 187.15, 188.35, 188.51, 188.46, 188.19, 187.2, 187.01, 187.17, 188.01, 188.35, 188.8, 188.78, 188.95, 191.51, 191.67, 190.43, 189.44, 188.13, 187.37, 187.91, 188.44, 191.45, 194.64, 197.86, 201.77, 206.63, 212.82, 218.07, 221.43, 224.31, 226.64, 228.58, 230.67, 230.35, 228.11, 225.47, 222.63, 219.53, 218.57, 218.2, 219.44, 222.17, 228.16, 232.05, 232.97, 238.8, 247.91, 256.32, 262.28, 269.87, 277.48, 282.96, 287.19, 291.1, 292.42, 293.18, 291.45, 290.94, 291.27, 289.72, 288.33, 286.02, 285.29, 284.24, 279.44, 278.6, 278.6, 278.84, 278.91, 278.27, 277.43, 275.38, 273.57, 270.79, 270.3, 268.02, 268.98, 267.93, 264.11, 262.66, 261.87, 265.01, 268.12, 270.1, 269.62, 268.14, 265.58, 263.97, 261.06, 259.0, 258.2, 255.51, 252.44, 249.39, 247.41, 244.75, 236.62, 236.09, 237.57, 240.36, 243.62, 246.95, 248.38, 249.22, 252.17, 253.99, 255.14, 255.16, 256.16, 256.19, 255.06, 257.31, 257.86, 256.71, 257.6, 257.68, 257.28, 256.93, 257.18, 257.66, 257.63, 257.63, 259.23, 259.61, 259.65, 259.41, 259.43, 259.55, 259.48, 259.59, 259.9, 258.01, 259.65, 259.87, 262.07, 263.68, 265.78, 266.45, 267.15, 270.3, 277.61, 282.67, 287.68, 291.33, 294.03, 296.49, 296.73, 297.23, 296.55, 295.48, 294.6, 294.16, 294.29, 293.59, 293.87, 294.33, 295.34, 297.3, 298.7, 300.67, 299.44, 299.3, 295.54, 291.94, 288.24, 283.91, 280.98, 277.9, 275.13, 274.97, 272.52, 267.48, 264.51, 268.03, 273.63, 273.69, 272.94, 273.26, 271.93, 271.17, 269.38, 268.44, 265.12, 261.01, 257.96, 253.31, 247.02, 240.13, 236.05, 234.78, 232.43, 226.76, 226.19, 226.59, 224.83, 225.67, 226.4, 226.75, 228.14, 229.23, 230.04, 229.82, 228.74, 226.9, 226.52, 225.95, 226.07, 225.37, 224.91, 225.5, 225.38, 225.39, 226.22, 226.99, 227.24, 227.49, 227.57, 227.66, 228.19, 228.14, 228.06, 227.5, 227.74, 227.56, 227.38, 227.46, 227.62, 227.46, 227.9, 230.17, 231.37, 236.59, 241.28, 246.5, 249.18, 250.36, 250.17, 250.51, 250.92, 251.2, 251.8, 252.38, 252.78, 252.97, 253.08, 253.28, 253.72, 253.84, 253.52, 252.21, 251.07, 247.17, 241.79, 233.23, 225.01, 215.37, 213.11, 211.83, 211.0, 209.55, 209.7, 210.04, 211.31, 210.53, 209.34, 208.65, 209.19, 210.33, 210.22, 210.18, 209.63, 209.33, 209.22, 209.27, 209.05, 208.64, 207.79, 207.92, 207.16, 207.23, 208.5, 213.08, 214.63, 216.28, 218.96, 221.56, 224.12, 226.64, 232.23, 239.01, 243.8, 247.29, 250.74, 253.67, 255.24, 256.66, 256.88, 257.75, 260.31, 260.68, 259.83, 259.8, 259.52, 257.84, 256.66, 255.19, 253.59, 252.44, 252.72, 252.39, 252.26, 252.23, 252.02, 251.77, 251.91, 251.68, 251.62, 251.4, 247.33, 245.08, 244.76, 244.62, 244.63, 244.93, 245.39, 247.08, 248.46, 250.34, 250.85, 249.32, 248.67, 247.81, 246.22, 243.62, 241.92, 239.96, 237.33, 235.31, 232.2, 229.11, 226.82, 223.71, 221.11, 217.58, 213.95, 212.86, 212.18, 212.18, 212.03, 212.23, 211.84, 211.27, 211.37, 211.05, 210.93, 210.4, 209.8, 209.09, 208.85, 208.66, 209.71, 209.97, 210.08, 210.5, 211.14, 211.5, 212.37, 212.78, 213.03, 212.85, 213.33, 213.31, 213.21, 214.92, 215.75, 216.68, 217.08, 216.7, 217.56, 219.07, 220.45, 220.76, 221.58, 222.73, 223.46, 223.21, 222.54, 221.85, 221.45, 221.18]}, {"name": "布林下軌", "color": "rgba(34,197,94,0.4)", "style": 2, "data": [null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, 146.54, 147.74, 148.36, 148.35, 148.52, 149.07, 150.26, 151.34, 151.3, 151.24, 151.24, 151.15, 151.19, 151.44, 149.91, 149.16, 148.47, 147.02, 144.25, 143.61, 143.74, 143.55, 143.64, 143.66, 143.6, 143.6, 143.56, 143.47, 143.47, 143.45, 143.48, 143.67, 143.85, 143.8, 144.31, 144.54, 144.71, 145.85, 148.9, 149.01, 149.49, 150.33, 150.17, 149.84, 149.02, 148.24, 148.37, 149.15, 149.72, 150.37, 151.14, 152.1, 153.55, 155.26, 155.28, 155.97, 156.3, 156.95, 157.25, 156.47, 157.22, 157.66, 157.91, 157.92, 157.72, 157.82, 158.07, 158.2, 158.4, 159.17, 157.56, 157.6, 158.22, 158.66, 158.75, 159.21, 159.55, 160.15, 161.19, 161.09, 162.31, 164.35, 164.79, 164.43, 162.64, 161.8, 160.85, 160.97, 159.95, 154.99, 150.63, 148.87, 147.91, 147.62, 147.88, 147.64, 147.41, 145.6, 144.06, 142.94, 141.48, 139.87, 137.93, 137.13, 138.12, 139.29, 141.16, 142.42, 144.53, 150.55, 158.69, 165.83, 172.92, 180.42, 185.08, 188.6, 191.46, 191.48, 189.74, 189.95, 191.33, 189.45, 184.99, 181.68, 181.02, 179.88, 179.32, 180.74, 182.66, 185.35, 189.58, 195.52, 201.85, 207.91, 213.48, 220.08, 224.92, 229.78, 231.76, 234.01, 241.96, 243.9, 243.45, 241.56, 240.59, 238.53, 235.12, 234.37, 233.68, 233.46, 231.6, 231.58, 231.72, 229.82, 229.84, 227.49, 225.08, 217.94, 209.98, 203.3, 198.78, 195.06, 193.02, 190.63, 189.94, 189.0, 187.2, 186.39, 186.41, 186.46, 186.84, 188.05, 193.28, 193.56, 192.68, 191.29, 189.73, 189.6, 191.57, 194.18, 195.58, 197.96, 200.06, 203.09, 204.89, 207.26, 211.49, 214.24, 217.59, 222.59, 225.2, 226.97, 228.72, 230.52, 230.97, 231.39, 231.22, 231.22, 228.57, 227.79, 226.15, 225.84, 225.22, 225.7, 225.52, 226.01, 226.5, 227.39, 226.5, 226.43, 225.13, 224.62, 224.22, 224.3, 224.35, 223.15, 220.24, 219.23, 220.72, 222.62, 225.37, 227.36, 231.22, 233.97, 237.85, 240.97, 244.05, 247.04, 248.16, 249.66, 248.68, 247.67, 245.46, 242.05, 239.3, 233.88, 230.56, 225.45, 224.96, 224.76, 223.71, 224.14, 224.72, 225.6, 225.27, 221.38, 220.08, 221.37, 218.44, 208.17, 194.12, 187.81, 183.16, 177.89, 175.22, 172.28, 170.02, 168.11, 165.93, 164.34, 163.69, 164.34, 167.08, 170.82, 172.9, 173.27, 174.37, 177.19, 177.31, 178.31, 183.92, 185.63, 186.95, 189.55, 190.16, 191.52, 192.86, 193.93, 197.56, 202.45, 204.88, 206.65, 206.68, 206.48, 206.49, 206.6, 206.57, 207.66, 208.43, 209.81, 210.66, 210.01, 209.78, 209.84, 209.71, 209.71, 209.69, 211.45, 211.66, 211.54, 211.17, 210.84, 210.93, 211.79, 212.15, 211.03, 211.13, 208.36, 205.87, 203.1, 202.57, 204.14, 204.68, 203.59, 201.73, 200.5, 198.6, 196.42, 194.32, 193.08, 192.32, 191.37, 188.83, 187.01, 185.38, 183.74, 182.18, 181.68, 182.21, 185.12, 188.89, 194.58, 195.44, 195.42, 195.65, 196.0, 194.6, 193.01, 192.39, 192.47, 192.36, 191.8, 190.31, 187.27, 185.63, 183.97, 183.32, 183.22, 183.18, 183.23, 183.2, 182.96, 182.96, 182.93, 183.19, 183.17, 183.0, 181.02, 180.07, 179.52, 178.84, 178.54, 178.88, 180.36, 179.82, 179.09, 179.55, 180.41, 181.46, 183.08, 185.51, 188.99, 193.17, 196.5, 199.69, 204.12, 208.67, 210.65, 213.08, 216.56, 218.84, 222.11, 225.21, 227.66, 227.93, 228.01, 227.99, 227.92, 227.53, 227.38, 226.69, 225.87, 225.48, 224.4, 226.12, 226.57, 225.29, 224.43, 222.92, 222.12, 221.16, 217.22, 213.49, 208.21, 203.35, 201.08, 197.38, 194.19, 192.63, 192.23, 191.53, 191.19, 191.32, 191.29, 191.85, 192.49, 192.83, 194.09, 194.84, 196.27, 198.1, 198.24, 198.42, 198.42, 198.72, 197.82, 198.96, 200.33, 199.98, 199.75, 199.12, 199.0, 198.95, 199.01, 199.1, 199.14, 198.54, 198.38, 198.37, 198.35, 198.21, 198.3, 197.98, 198.17, 198.72, 199.85, 199.87, 199.74, 200.29, 199.93, 200.6, 201.02, 201.82, 202.8, 201.29, 198.78, 195.5, 193.69, 191.42, 188.17, 185.04, 183.84, 182.46, 182.05, 182.05, 182.07]}], "equity": [1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 1000000, 998748, 1022748, 1022748, 995748, 965748, 1010748, 1034748, 1025748, 1061748, 1058748, 1070748, 1058748, 1067748, 1037748, 1049748, 1046748, 1040748, 1040748, 1034748, 1034748, 1079748, 1064748, 1076748, 1073748, 1088748, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1114328, 1112842, 1091842, 1151342, 1186342, 1214342, 1298342, 1343842, 1347342, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1435771, 1433985, 1385985, 1379985, 1400985, 1397985, 1430985, 1418985, 1463985, 1457985, 1421985, 1433985, 1460985, 1451985, 1505985, 1553985, 1559985, 1565985, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1610627, 1608433, 1456433, 1592433, 1624433, 1580433, 1672433, 1644433, 1660433, 1672433, 1604433, 1596433, 1676433, 1708433, 1804433, 1844433, 1832433, 1780433, 1812433, 1736433, 1740433, 1720433, 1764433, 1796433, 1788433, 1816433, 1832433, 1840433, 1832433, 1740433, 1808433, 1840433, 1840433, 1804433, 1816433, 1772433, 1796433, 1836433, 1800433, 1824433, 1868433, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1884362, 1881934, 1865934, 1801934, 1773934, 1825934, 1761934, 1761934, 1813934, 1845934, 1841934, 1849934, 1849934, 1849934, 1837934, 1829934, 1829934, 1853934, 1821934, 1809934, 1813934, 1805934, 1825934, 1801934, 1785934, 1769934, 1821934, 1825934, 1793934, 1801934, 1781934, 1797934, 1797934, 1797934, 1825934, 1817934, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1858465, 1855965, 1828965, 1860465, 1828965, 1783965, 1770465, 1842465, 1819965, 1882965, 1945965, 1946762], "trades": [{"buy_date": "2024-04-16", "buy_price": 146.5, "sell_date": "2024-05-22", "sell_price": 166.5, "ret_pct": 13.65, "reason": "signal"}, {"buy_date": "2024-08-05", "buy_price": 149.0, "sell_date": "2024-08-15", "sell_price": 196.0, "ret_pct": 31.54, "reason": "signal"}, {"buy_date": "2024-11-14", "buy_price": 209.0, "sell_date": "2024-12-09", "sell_price": 239.5, "ret_pct": 14.59, "reason": "signal"}, {"buy_date": "2025-04-08", "buy_price": 192.5, "sell_date": "2025-06-05", "sell_price": 228.0, "ret_pct": 18.44, "reason": "signal"}, {"buy_date": "2025-11-14", "buy_price": 213.0, "sell_date": "2026-01-06", "sell_price": 211.0, "ret_pct": -0.94, "reason": "signal"}, {"buy_date": "2026-02-02", "buy_price": 195.0, "sell_date": "2026-02-25", "sell_price": 206.0, "ret_pct": 5.64, "reason": "forced_close"}]};

const stats = document.getElementById('stats-bar');
const totalRet = ((DATA.equity[DATA.equity.length-1] - 1000000) / 1000000 * 100).toFixed(1);
const wins = DATA.trades.filter(t => t.ret_pct > 0).length;
const losses = DATA.trades.length - wins;
const stops = DATA.trades.filter(t => t.reason === 'stop_loss').length;
const winRate = (wins / DATA.trades.length * 100).toFixed(1);
const avgRet = (DATA.trades.reduce((s,t) => s + t.ret_pct, 0) / DATA.trades.length).toFixed(2);

const statItems = [
  { label: '總報酬', value: `+${totalRet}%`, cls: 'green' },
  { label: '最終資金', value: DATA.equity[DATA.equity.length-1].toLocaleString(), cls: 'blue' },
  { label: '交易次數', value: DATA.trades.length, cls: '' },
  { label: '勝率', value: `${winRate}%`, cls: parseFloat(winRate) >= 50 ? 'green' : 'red' },
  { label: '勝 / 負 / 停損', value: `${wins} / ${losses} / ${stops}`, cls: '' },
  { label: '平均報酬', value: `${avgRet}%`, cls: parseFloat(avgRet) >= 0 ? 'green' : 'red' },
];
stats.innerHTML = statItems.map(s =>
  `<div class="stat"><span class="label">${s.label}</span><span class="value ${s.cls}">${s.value}</span></div>`
).join('');

// Price Chart
const priceEl = document.getElementById('price-chart');
const priceChart = LightweightCharts.createChart(priceEl, {
  layout: { background: { color: '#0f1320' }, textColor: '#6b7280', fontSize: 11 },
  grid: { vertLines: { color: '#1a1f2e' }, horzLines: { color: '#1a1f2e' } },
  crosshair: { mode: LightweightCharts.CrosshairMode.Normal },
  rightPriceScale: { borderColor: '#1e2433' },
  timeScale: { borderColor: '#1e2433', timeVisible: false },
});

const closeSeries = priceChart.addLineSeries({ color: '#3b82f6', lineWidth: 2, priceLineVisible: false, lastValueVisible: false });
closeSeries.setData(DATA.dates.map((d, i) => ({ time: d, value: DATA.closes[i] })));

// Overlay lines
DATA.overlays.forEach(ov => {
  const s = priceChart.addLineSeries({
    color: ov.color, lineWidth: 1, lineStyle: ov.style || 0,
    priceLineVisible: false, lastValueVisible: false,
  });
  s.setData(DATA.dates.map((d, i) => ov.data[i] !== null ? { time: d, value: ov.data[i] } : null).filter(Boolean));
});

// Markers
const buyMarkers = DATA.trades.map(t => ({
  time: t.buy_date, position: 'belowBar', color: '#22c55e', shape: 'arrowUp',
  text: `B ${t.buy_price}`,
}));
const sellMarkers = DATA.trades.map(t => ({
  time: t.sell_date, position: 'aboveBar',
  color: t.reason === 'stop_loss' ? '#f59e0b' : '#ef4444', shape: 'arrowDown',
  text: `${t.reason === 'stop_loss' ? 'SL' : 'S'} ${t.sell_price}`,
}));
closeSeries.setMarkers([...buyMarkers, ...sellMarkers].sort((a,b) => a.time < b.time ? -1 : 1));
priceChart.timeScale().fitContent();

// Equity Chart
const eqEl = document.getElementById('equity-chart');
const eqChart = LightweightCharts.createChart(eqEl, {
  layout: { background: { color: '#0f1320' }, textColor: '#6b7280', fontSize: 11 },
  grid: { vertLines: { color: '#1a1f2e' }, horzLines: { color: '#1a1f2e' } },
  crosshair: { mode: LightweightCharts.CrosshairMode.Normal },
  rightPriceScale: { borderColor: '#1e2433' },
  timeScale: { borderColor: '#1e2433', timeVisible: false },
});
const eqSeries = eqChart.addAreaSeries({
  topColor: 'rgba(34,197,94,0.3)', bottomColor: 'rgba(34,197,94,0.02)',
  lineColor: '#22c55e', lineWidth: 2, priceLineVisible: false, lastValueVisible: true,
});
eqSeries.setData(DATA.dates.map((d, i) => ({ time: d, value: DATA.equity[i] })));
const baseSeries = eqChart.addLineSeries({
  color: 'rgba(107,114,128,0.3)', lineWidth: 1, lineStyle: 2,
  priceLineVisible: false, lastValueVisible: false,
});
baseSeries.setData(DATA.dates.map(d => ({ time: d, value: 1000000 })));
eqChart.timeScale().fitContent();

// Trades Table
const tableEl = document.getElementById('trades-tbody');
let html = `<thead><tr><th>#</th><th>買入日期</th><th>買入價</th><th>賣出日期</th><th>賣出價</th><th>持有天數</th><th>報酬</th><th>出場</th><th>累計資金</th></tr></thead><tbody>`;
DATA.trades.forEach((t, i) => {
  const holdDays = Math.round((new Date(t.sell_date) - new Date(t.buy_date)) / 86400000);
  const sellIdx = DATA.dates.indexOf(t.sell_date);
  const eqAtSell = sellIdx >= 0 ? DATA.equity[sellIdx].toLocaleString() : '';
  const retCls = t.ret_pct > 0 ? 'win' : 'lose';
  const tagMap = { stop_loss: 'stop-tag">停損', signal: 'signal-tag">訊號', forced_close: 'forced-tag">強制平倉' };
  const tag = tagMap[t.reason] || 'signal-tag">' + t.reason;
  html += `<tr><td>${i+1}</td><td>${t.buy_date}</td><td>${t.buy_price.toFixed(2)}</td><td>${t.sell_date}</td><td>${t.sell_price.toFixed(2)}</td><td>${holdDays}天</td><td class="${retCls}">${t.ret_pct > 0 ? '+' : ''}${t.ret_pct.toFixed(2)}%</td><td><span class="${tag}</span></td><td>${eqAtSell}</td></tr>`;
});
html += '</tbody>';
tableEl.innerHTML = html;

function handleResize() {
  priceChart.applyOptions({ width: priceEl.clientWidth });
  eqChart.applyOptions({ width: eqEl.clientWidth });
}
window.addEventListener('resize', handleResize);
handleResize();
</script>
</body>
</html>